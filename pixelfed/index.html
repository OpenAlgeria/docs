



<!DOCTYPE html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation, Tutorial, Support">
      
      
        <link rel="canonical" href="https://social.openalgeria.org/@nhaddag/pixelfed/">
      
      
        <meta name="author" content="Noureddine HADDAG">
      
      
        <meta name="lang:clipboard.copy" content="Copier dans le presse-papier">
      
        <meta name="lang:clipboard.copied" content="Copié dans le presse-papier">
      
        <meta name="lang:search.language" content="fr">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="Aucun document trouvé">
      
        <meta name="lang:search.result.one" content="1 document trouvé">
      
        <meta name="lang:search.result.other" content="# documents trouvés">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>OpenAlgeria Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#pixelfed-federated-image-sharing" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://social.openalgeria.org/@nhaddag" title="OpenAlgeria Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                OpenAlgeria Documentation
              </span>
              <span class="md-header-nav__topic">
                PixelFed
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Taper pour démarrer la recherche
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/openalgeria/docs/" title="Aller au dépôt" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      OpenAlgeria/docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="Accueil" class="md-tabs__link md-tabs__link--active">
        Accueil
      </a>
    
  </li>

      
        
  <li class="md-tabs__item">
    
      <a href="./" title="PixelFed" class="md-tabs__link md-tabs__link--active">
        PixelFed
      </a>
    
  </li>

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://social.openalgeria.org/@nhaddag" title="OpenAlgeria Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    OpenAlgeria Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/openalgeria/docs/" title="Aller au dépôt" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      OpenAlgeria/docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Accueil" class="md-nav__link">
      Accueil
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        PixelFed
      </label>
    
    <a href="./" title="PixelFed" class="md-nav__link md-nav__link--active">
      PixelFed
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table des matières</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependances-requises" title="Dépendances requises" class="md-nav__link">
    Dépendances requises
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preparer-le-systeme" title="Préparer le système" class="md-nav__link">
    Préparer le système
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preparer-lutilisateur-pixelfed-et-la-base-de-donnees" title="Préparer l'utilisateur PixelFed et la base de données" class="md-nav__link">
    Préparer l'utilisateur PixelFed et la base de données
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mise-en-place-de-pixelfed" title="Mise en place de PixelFed" class="md-nav__link">
    Mise en place de PixelFed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-serveur-web" title="Configuration serveur web" class="md-nav__link">
    Configuration serveur web
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lets-encrypt-certificate" title="Let's Encrypt Certificate" class="md-nav__link">
    Let's Encrypt Certificate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table des matières</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependances-requises" title="Dépendances requises" class="md-nav__link">
    Dépendances requises
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preparer-le-systeme" title="Préparer le système" class="md-nav__link">
    Préparer le système
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preparer-lutilisateur-pixelfed-et-la-base-de-donnees" title="Préparer l'utilisateur PixelFed et la base de données" class="md-nav__link">
    Préparer l'utilisateur PixelFed et la base de données
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mise-en-place-de-pixelfed" title="Mise en place de PixelFed" class="md-nav__link">
    Mise en place de PixelFed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-serveur-web" title="Configuration serveur web" class="md-nav__link">
    Configuration serveur web
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lets-encrypt-certificate" title="Let's Encrypt Certificate" class="md-nav__link">
    Let's Encrypt Certificate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/openalgeria/docs/edit/master/docs/pixelfed/index.md" title="Editer cette page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="pixelfed-federated-image-sharing">PixelFed: Federated Image Sharing<a class="headerlink" href="#pixelfed-federated-image-sharing" title="Permanent link">&para;</a></h1>
<p><img alt="Screenshot" src="https://cybercratia.cl/wp-content/uploads/2018/06/3ac84e64c2b638e3.png" />
PixelFed est une plate-forme de partage d'image sociale fédérée, similaire à Instagram. La Fédération se fait en utilisant le protocole  <a href="https://activitypub.rocks/">ActivityPub</a>, 
qui est utilisé aussi par  <a href="http://joinmastodon.org/">Mastodon</a>, <a href="https://joinpeertube.org/fr/">PeerTube</a>, <a href="https://activitypub.rocks/">Pleroma</a>,
et plus encore. Grâce à ActivityPub de PixelFed vous pouvez partager et interagir avec ces plates-formes, ainsi que d'autres instances de PixelFed.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>S'il vous plaît noter que c'est une version  alpha,  et la Fédération n'est pas encore pris en charge.</p>
</div>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p>Ce tutorial suppose que vous êtes sur une distribution Debian Stretch. Il  devrait également fonctionner avec Ubuntu 16,04.</p>
<h3 id="dependances-requises">Dépendances requises<a class="headerlink" href="#dependances-requises" title="Permanent link">&para;</a></h3>
<ul>
<li>PHP &gt;= 7.1.3 (7.2+ la version stable est recommandé)</li>
<li>MySQL &gt;= 5.7, Postgres (MariaDB et SQLite ne sont pas encore pris en charge)</li>
<li>Redis</li>
<li>Composer</li>
<li>GD or ImageMagick</li>
<li>OpenSSL PHP Extension</li>
<li>PDO PHP Extension</li>
<li>Mbstring PHP Extension</li>
<li>Tokenizer PHP Extension</li>
<li>XML PHP Extension</li>
<li>Ctype PHP Extension</li>
<li>JSON PHP Extension</li>
<li>JpegOptim</li>
<li>Optipng</li>
<li>Pngquant 2</li>
<li>SVGO</li>
<li>Gifsicle</li>
</ul>
<h3 id="preparer-le-systeme">Préparer le système<a class="headerlink" href="#preparer-le-systeme" title="Permanent link">&para;</a></h3>
<p>Toutes les dépendances doivent être installées en tant que root.</p>
<ul>
<li>PHP Repos
<div class="codehilite"><pre><span></span><span class="n">apt</span> <span class="n">-y</span> <span class="n">install</span> <span class="n">apt-transport-https</span> <span class="n">lsb-release</span> <span class="n">ca-certificates</span>
<span class="n">wget</span> <span class="n">-O</span> <span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">apt</span><span class="p">/</span><span class="n">trusted</span><span class="p">.</span><span class="n">gpg</span><span class="p">.</span><span class="n">d</span><span class="p">/</span><span class="n">php</span><span class="p">.</span><span class="n">gpg</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">packages</span><span class="p">.</span><span class="n">sury</span><span class="p">.</span><span class="n">org</span><span class="p">/</span><span class="n">php</span><span class="p">/</span><span class="n">apt</span><span class="p">.</span><span class="n">gpg</span>
<span class="n">echo</span> <span class="s2">&quot;deb https://packages.sury.org/php/ </span><span class="p">$(</span><span class="n">lsb_release</span> <span class="n">-sc</span><span class="p">)</span><span class="s2"> main&quot;</span> <span class="p">|</span> <span class="n">tee</span> <span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">apt</span><span class="p">/</span><span class="n">sources</span><span class="p">.</span><span class="n">list</span><span class="p">.</span><span class="n">d</span><span class="p">/</span><span class="n">php</span><span class="p">.</span><span class="n">list</span>
<span class="n">apt</span> <span class="n">update</span> <span class="p">&amp;&amp;</span> <span class="n">apt</span> <span class="n">dist-upgrade</span>
</pre></div></li>
<li>Installer les dépendances, qui sont nécessaires plus tard:
<div class="codehilite"><pre><span></span><span class="n">apt</span> <span class="n">-y</span> <span class="n">install</span> <span class="n">git</span> <span class="n">imagemagick</span> <span class="n">nginx</span> <span class="n">supervisor</span> <span class="n">redis-server</span> <span class="n">redis-tools</span> <span class="n">postgresql</span> <span class="n">postgresql-contrib</span> <span class="n">certbot</span> <span class="n">php7</span><span class="p">.</span><span class="n">2</span> <span class="n">php7</span><span class="p">.</span><span class="n">2-cli</span> <span class="n">php7</span><span class="p">.</span><span class="n">2-xml</span> <span class="n">php7</span><span class="p">.</span><span class="n">2-gd</span> <span class="n">openssl</span> <span class="n">php7</span><span class="p">.</span><span class="n">2-pgsql</span> <span class="n">php7</span><span class="p">.</span><span class="n">2-mbstring</span> <span class="n">php7</span><span class="p">.</span><span class="n">2-common</span> <span class="n">php7</span><span class="p">.</span><span class="n">2-tokenizer</span> <span class="n">php7</span><span class="p">.</span><span class="n">2-json</span> <span class="n">php7</span><span class="p">.</span><span class="n">2-bcmath</span> <span class="n">jpegoptim</span> <span class="n">optipng</span> <span class="n">pngquant</span> <span class="n">gifsicle</span>
</pre></div></li>
<li>Installer Composer:
<div class="codehilite"><pre><span></span>curl -sS https://getcomposer.org/installer <span class="p">|</span> php
mv composer.phar /usr/local/bin/composer
chmod +x /usr/local/bin/composer
</pre></div></li>
<li>Installer SVGO compresseur d'images
<div class="codehilite"><pre><span></span><span class="n">npm</span> <span class="n">install</span> <span class="n">-g</span> <span class="n">svgo</span>
</pre></div></li>
</ul>
<h3 id="preparer-lutilisateur-pixelfed-et-la-base-de-donnees">Préparer l'utilisateur PixelFed et la base de données<a class="headerlink" href="#preparer-lutilisateur-pixelfed-et-la-base-de-donnees" title="Permanent link">&para;</a></h3>
<ul>
<li>Créons d'abord cet utilisateur:
<div class="codehilite"><pre><span></span><span class="n">adduser</span> <span class="n">pixelfed</span>
</pre></div></li>
<li>Création de bases de données :</li>
</ul>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">PostgreSQL</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="o">#</span> <span class="n">Cr</span><span class="err">é</span><span class="n">ez</span> <span class="n">la</span> <span class="n">base</span> <span class="n">de</span> <span class="n">donn</span><span class="err">é</span><span class="n">es</span> <span class="n">de</span> <span class="n">production</span> <span class="n">et</span> <span class="n">un</span> <span class="n">utilisateur</span> <span class="n">pixelfed</span> <span class="err">à</span> <span class="n">l</span><span class="err">&#39;</span><span class="nb">int</span><span class="err">é</span><span class="n">rieur</span> <span class="n">de</span> <span class="n">PostgreSQL</span><span class="p">:</span>
<span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">postgres</span> <span class="k">createuser</span> <span class="o">-</span><span class="n">P</span> <span class="n">pixelfed</span>
<span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">postgres</span> <span class="k">createdb</span> <span class="o">-</span><span class="n">O</span> <span class="n">pixelfed</span> <span class="n">pixelfed_prod</span>
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">MySQL</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="c1"># Connectez-vous à votre base de données MySQL en tant que root en tapant:</span>
<span class="n">mysql</span> <span class="o">-</span><span class="n">p</span>
<span class="c1"># Créer un utilisateur et un mot de passe de base de données :</span>
<span class="k">create</span> <span class="k">database</span> <span class="n">pixelfed_prod</span><span class="p">;</span>
<span class="k">grant</span> <span class="k">all</span> <span class="n">privileges</span> <span class="k">on</span> <span class="n">pixelfed_prod</span><span class="p">.</span><span class="o">*</span> <span class="k">to</span> <span class="s1">&#39;pixelfed&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">identified</span> <span class="k">by</span> <span class="s2">&quot;mots de passe db&quot;</span><span class="p">;</span> 
<span class="k">flush</span> <span class="n">privileges</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;</span>
</pre></div></div>
</div>
<h3 id="mise-en-place-de-pixelfed">Mise en place de PixelFed<a class="headerlink" href="#mise-en-place-de-pixelfed" title="Permanent link">&para;</a></h3>
<p>La suite des dépendances qui doivent être ajoutées en tant qu'utilisateur non-root
<div class="codehilite"><pre><span></span><span class="c"># Connectez-vous en tant qu&#39;utilisateur pixelfed</span>
<span class="n">su</span> <span class="p">-</span> <span class="n">pixelfed</span>
<span class="c"># Cloner le dépôt PixelFed dans ~/live</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">pixelfed</span><span class="p">/</span><span class="n">pixelfed</span><span class="p">.</span><span class="n">git</span> <span class="n">live</span>
<span class="c"># Changer de répertoire à ~/live</span>
<span class="n">cd</span> <span class="p">~/</span><span class="n">live</span>
<span class="c"># Installer les dépendances via composer</span>
<span class="n">composer</span> <span class="n">install</span>
<span class="c"># Copier le fichier de config .env</span>
<span class="n">cp</span> <span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">example</span> <span class="p">.</span><span class="n">env</span>
</pre></div></p>
<ul>
<li>Passons à la configuration avant de continuer:</li>
</ul>
<p><div class="codehilite"><pre><span></span><span class="n">nano</span> <span class="p">.</span><span class="n">env</span>
</pre></div>
<div class="codehilite"><pre><span></span><span class="c1"># Nom et URL de l&#39;instance </span>
<span class="nv">APP_NAME</span><span class="o">=</span><span class="s2">&quot;PixelFed Instance&quot;</span>        
<span class="nv">APP_ENV</span><span class="o">=</span>Production
<span class="nv">APP_KEY</span><span class="o">=</span>
<span class="nv">APP_DEBUG</span><span class="o">=</span><span class="nb">false</span>
<span class="nv">APP_URL</span><span class="o">=</span>https://exemple.com

<span class="nv">ADMIN_DOMAIN</span><span class="o">=</span><span class="s2">&quot;exemple.com&quot;</span>
<span class="nv">APP_DOMAIN</span><span class="o">=</span><span class="s2">&quot;exemple.com&quot;</span>

<span class="nv">LOG_CHANNEL</span><span class="o">=</span>stack

<span class="c1"># Définir le type et l&#39;identifiant de la base de donnees (pgsql = PostgreSQL , mysql = MySQL).</span>
<span class="nv">DB_CONNECTION</span><span class="o">=</span>pgsql
<span class="nv">DB_HOST</span><span class="o">=</span><span class="m">127</span>.0.0.1
<span class="nv">DB_PORT</span><span class="o">=</span><span class="m">5432</span>
<span class="nv">DB_DATABASE</span><span class="o">=</span>pixelfed_prod
<span class="nv">DB_USERNAME</span><span class="o">=</span>pixelfed
<span class="nv">DB_PASSWORD</span><span class="o">=</span>mots de passe db

<span class="c1"># Configuration du serveur Redis</span>
<span class="nv">BROADCAST_DRIVER</span><span class="o">=</span>log
<span class="nv">CACHE_DRIVER</span><span class="o">=</span>redis
<span class="nv">SESSION_DRIVER</span><span class="o">=</span>redis
<span class="nv">SESSION_LIFETIME</span><span class="o">=</span><span class="m">120</span>
<span class="nv">QUEUE_DRIVER</span><span class="o">=</span>redis

<span class="nv">REDIS_HOST</span><span class="o">=</span><span class="m">127</span>.0.0.1
<span class="nv">REDIS_PASSWORD</span><span class="o">=</span>null
<span class="nv">REDIS_PORT</span><span class="o">=</span><span class="m">6379</span>

<span class="c1"># Config de la Federation</span>
<span class="nv">ACTIVITY_PUB</span><span class="o">=</span><span class="nb">true</span>

<span class="c1"># Configuration du serveur mail</span>
<span class="nv">MAIL_DRIVER</span><span class="o">=</span>smtp
<span class="nv">MAIL_HOST</span><span class="o">=</span>smtp.mailtrap.io
<span class="nv">MAIL_PORT</span><span class="o">=</span><span class="m">2525</span>
<span class="nv">MAIL_USERNAME</span><span class="o">=</span>null
<span class="nv">MAIL_PASSWORD</span><span class="o">=</span>null
<span class="nv">MAIL_ENCRYPTION</span><span class="o">=</span>null
<span class="nv">MAIL_FROM_ADDRESS</span><span class="o">=</span><span class="s2">&quot;pixelfed@example.com&quot;</span>
<span class="nv">MAIL_FROM_NAME</span><span class="o">=</span><span class="s2">&quot;Pixelfed&quot;</span>

<span class="c1"># API</span>
<span class="nv">SESSION_DOMAIN</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">APP_DOMAIN</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">SESSION_SECURE_COOKIE</span><span class="o">=</span><span class="nb">true</span>
<span class="nv">API_BASE</span><span class="o">=</span><span class="s2">&quot;/api/1/&quot;</span>
<span class="nv">API_SEARCH</span><span class="o">=</span><span class="s2">&quot;/api/search&quot;</span>

<span class="nv">OPEN_REGISTRATION</span><span class="o">=</span><span class="nb">true</span>
<span class="nv">RECAPTCHA_ENABLED</span><span class="o">=</span><span class="nb">false</span>
<span class="nv">ENFORCE_EMAIL_VERIFICATION</span><span class="o">=</span><span class="nb">true</span>

<span class="nv">MAX_PHOTO_SIZE</span><span class="o">=</span><span class="m">15000</span>
<span class="nv">MAX_CAPTION_LENGTH</span><span class="o">=</span><span class="m">150</span>
<span class="nv">MAX_ALBUM_LENGTH</span><span class="o">=</span><span class="m">4</span>

<span class="nv">MIX_PUSHER_APP_KEY</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PUSHER_APP_KEY</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">MIX_PUSHER_APP_CLUSTER</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PUSHER_APP_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">MIX_APP_URL</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">APP_URL</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">MIX_API_BASE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">API_BASE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">MIX_API_SEARCH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">API_SEARCH</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div></p>
<ul>
<li>Générer la clé de l'application APP_KEY</li>
</ul>
<div class="codehilite"><pre><span></span>php artisan key:generate
</pre></div>

<ul>
<li>Finalisant l'installation</li>
</ul>
<div class="codehilite"><pre><span></span>php artisan storage:link
php artisan migrate
</pre></div>

<ul>
<li>Premier lancement https://localhost:8000/</li>
</ul>
<div class="codehilite"><pre><span></span>php artisan horizon
</pre></div>

<h3 id="configuration-serveur-web">Configuration serveur web<a class="headerlink" href="#configuration-serveur-web" title="Permanent link">&para;</a></h3>
<p>Vous devez configurer <a href="http://nginx.org/">Nginx</a> pour servir votre instance PixelFed.</p>
<details class="info" open="open"><summary>Rappel</summary><p>remplacez toutes les occurrences de example.com par le domaine ou le sous-domaine de votre propre instance.</p></details><ul>
<li>Ouvrir un nouveau fichier:</li>
</ul>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">Nginx</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>nano /etc/nginx/sites-enabled/pixelfed.conf
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_1" />
<label for="__tab_2_1">Apache</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>nano /etc/apache2/sites-available/pixelfed.conf
</pre></div></div>
</div>
<ul>
<li>Copiez et collez les éléments suivants et effectuez les modifications nécessaires:</li>
</ul>
<div class="superfences-tabs">
<input name="__tabs_3" type="radio" id="__tab_3_0" checked="checked" />
<label for="__tab_3_0">Nginx</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">exemple.com</span><span class="p">;</span>
    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">443</span> <span class="s">ssl</span><span class="p">;</span>

    <span class="kn">root</span> <span class="s">/home/pixelfed/live/public</span><span class="p">;</span>

    <span class="kn">server_name</span> <span class="s">exemple.com</span><span class="p">;</span>

    <span class="kn">client_max_body_size</span> <span class="s">20M</span><span class="p">;</span>
    <span class="kn">ssl</span> <span class="no">on</span><span class="p">;</span>
    <span class="kn">index</span> <span class="s">index.php</span> <span class="s">index.html</span><span class="p">;</span>

    <span class="kn">ssl_protocols</span> <span class="s">TLSv1.2</span><span class="p">;</span>
    <span class="kn">ssl_ciphers</span> <span class="s">HIGH:!MEDIUM:!LOW:!aNULL:!NULL:!SHA</span><span class="p">;</span>
    <span class="kn">ssl_prefer_server_ciphers</span> <span class="no">on</span><span class="p">;</span>
    <span class="kn">ssl_session_cache</span> <span class="s">shared:SSL:10m</span><span class="p">;</span>

    <span class="kn">ssl_certificate</span> <span class="s">/etc/letsencrypt/live/exemple.com/fullchain.pem</span><span class="p">;</span>
    <span class="kn">ssl_certificate_key</span> <span class="s">/etc/letsencrypt/live/exemple.com/privkey.pem</span><span class="p">;</span>

    <span class="kn">ssl_stapling</span> <span class="no">on</span><span class="p">;</span>
    <span class="kn">ssl_stapling_verify</span> <span class="no">on</span><span class="p">;</span>
    <span class="kn">ssl_trusted_certificate</span> <span class="s">/etc/letsencrypt/live/exemple.com/fullchain.pem</span><span class="p">;</span>

    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="nv">$uri/</span> <span class="s">/</span><span class="nv">$is_args$args</span><span class="p">;</span>
    <span class="p">}</span> 


    <span class="kn">location</span> <span class="p">~</span> <span class="sr">\.php$</span> <span class="p">{</span>
        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="p">=</span><span class="mi">404</span><span class="p">;</span>
        <span class="kn">fastcgi_index</span> <span class="s">index.php</span><span class="p">;</span>
        <span class="kn">fastcgi_pass</span> <span class="s">unix:/run/php/php7.2-fpm.sock</span><span class="p">;</span>
        <span class="kn">fastcgi_param</span> <span class="s">SCRIPT_FILENAME</span> <span class="nv">$document_root$fastcgi_script_name</span><span class="p">;</span>
        <span class="kn">include</span> <span class="s">/etc/nginx/fastcgi_params</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div></div>
<input name="__tabs_3" type="radio" id="__tab_3_1" />
<label for="__tab_3_1">Apache</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="nb">Pas</span> encore disponible
</pre></div></div>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Cette configuration fait l'hypothèse que vous utilisez let's Encrypt en tant que fournisseur de certificats TLS.</p>
</div>
<h3 id="lets-encrypt-certificate">Let's Encrypt Certificate<a class="headerlink" href="#lets-encrypt-certificate" title="Permanent link">&para;</a></h3>
<p><a href="https://letsencrypt.org/">Let's Encrypt</a> certificates ont une période de validité de 90 jours.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Assurez-vous de remplacer toute occurrence de 'example.com' par le domaine de votre instance de PixelFed</p>
</div>
<ul>
<li>Arrêtez Nginx</li>
</ul>
<div class="codehilite"><pre><span></span>systemctl stop nginx
</pre></div>

<ul>
<li>Nous allons créer le certificat deux fois, une fois avec TLS SNI validation en mode autonome et la deuxième fois que nous allons utiliser la méthode Webroot. Cela est nécessaire en raison de la façon Nginx et l'outil let's Encrypt fonctionne.</li>
</ul>
<div class="codehilite"><pre><span></span>certbot certonly --standalone -d example.com
</pre></div>

<ul>
<li>Une fois le certificat générer, nous allons utiliser la méthode Webroot. Cela nécessite Nginx soit en cours d'exécution:</li>
</ul>
<div class="codehilite"><pre><span></span>systemctl start nginx
<span class="c1"># L&#39;outil certbot vous demandera si vous voulez émettre un nouveau CERTIFICAT, s&#39;il vous plaît choisissez cette option</span>
certbot certonly --webroot -d example.com -w /home/pixelfed/live/public/
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Accueil" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Précédent
                </span>
                Accueil
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2017 Martin Donath
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/squidfunk" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/squidfunk" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/squidfunk" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.583bbe55.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
                <script src="../assets/javascripts/lunr/lunr.fr.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>